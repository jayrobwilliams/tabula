<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Seriation • tabula</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Seriation">
<meta property="og:description" content="tabula">
<meta property="og:image" content="https://tabula.tesselle.org/logo.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@nfrerebeau">
<meta name="twitter:site" content="@nfrerebeau">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tabula</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/diversity.html">Diversity Measures</a>
    </li>
    <li>
      <a href="../articles/seriation.html">Seriation Methods</a>
    </li>
    <li>
      <a href="../articles/dating.html">Dating Methods</a>
    </li>
    <li>
      <a href="../articles/bibliography.html">Bibliography</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nfrerebeau/tabula">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="seriation_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Seriation</h1>
                        <h4 class="author">N. Frerebeau</h4>
            
            <h4 class="date">2021-03-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/tesselle/tabula/blob/master/vignettes/seriation.Rmd"><code>vignettes/seriation.Rmd</code></a></small>
      <div class="hidden name"><code>seriation.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load packages</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tabula.tesselle.org">tabula</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://folio.tesselle.org">folio</a></span><span class="op">)</span> <span class="co"># Datasets</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dimensio.tesselle.org">dimensio</a></span><span class="op">)</span> <span class="co"># Multivariate analysis</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span></code></pre></div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The matrix seriation problem in archaeology is based on three conditions and two assumptions, which <span class="citation">Dunnell (1970)</span> summarizes as follows.</p>
<p>The homogeneity conditions state that all the groups included in a seriation must:</p>
<ul>
<li>Be of comparable duration,</li>
<li>Belong to the same cultural tradition,</li>
<li>Come from the same local area.</li>
</ul>
<p>The mathematical assumptions state that the distribution of any historical or temporal class:</p>
<ul>
<li>Is continuous through time,</li>
<li>Exhibits the form of a unimodal curve.</li>
</ul>
<p>Theses assumptions create a distributional model and ordering is accomplished by arranging the matrix so that the class distributions approximate the required pattern. The resulting order is <em>inferred</em> to be chronological.</p>
</div>
<div id="reciprocal-ranking" class="section level1">
<h1 class="hasAnchor">
<a href="#reciprocal-ranking" class="anchor"></a>Reciprocal ranking</h1>
<p>Reciprocal ranking iteratively rearrange rows and/or columns according to their weighted rank in the data matrix until convergence <span class="citation">(Ihm 2005)</span>.</p>
<p>For a given incidence matrix <span class="math inline">\(C\)</span>:</p>
<ul>
<li>The rows of <span class="math inline">\(C\)</span> are rearranged in increasing order of:</li>
</ul>
<p><span class="math display">\[ x_{i} = \sum_{j = 1}^{p} j \frac{c_{ij}}{c_{i \cdot}} \]</span></p>
<ul>
<li>The columns of <span class="math inline">\(C\)</span> are rearranged in a similar way:</li>
</ul>
<p><span class="math display">\[ y_{j} = \sum_{i = 1}^{m} i \frac{c_{ij}}{c_{\cdot j}} \]</span></p>
<p>These two steps are repeated until convergence. Note that this procedure could enter into an infinite loop.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Build an incidence matrix with random data</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span>
<span class="va">bin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">1</span>, <span class="fl">400</span>, <span class="cn">TRUE</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span>
<span class="va">incidence1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://arkhe.tesselle.org/reference/IncidenceMatrix-class.html">IncidenceMatrix</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">bin</span>, nrow <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>

<span class="co">## Get seriation order on rows and columns</span>
<span class="co">## If no convergence is reached before the maximum number of iterations (100), </span>
<span class="co">## it stops with a warning.</span>
<span class="op">(</span><span class="va">indices</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/seriation.html">seriate_rank</a></span><span class="op">(</span><span class="va">incidence1</span>, margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, stop <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; &lt;PermutationOrder: reciprocal ranking&gt;</span>
<span class="co">#&gt; Permutation order for matrix seriation:</span>
<span class="co">#&gt; - Row order: 1 4 20 3 9 16 19 10 13 2 11 7 17 5 6 18 14 15 8 12...</span>
<span class="co">#&gt; - Column order: 1 16 9 4 8 14 3 20 13 2 6 18 7 17 5 11 19 12 15 10...</span>

<span class="co">## Permute matrix rows and columns</span>
<span class="va">incidence2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/seriation.html">permute</a></span><span class="op">(</span><span class="va">incidence1</span>, <span class="va">indices</span><span class="op">)</span>

<span class="co">## Plot matrix</span>
<span class="fu"><a href="../reference/plot_matrix.html">plot_heatmap</a></span><span class="op">(</span><span class="va">incidence1</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Original matrix"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"TRUE"</span> <span class="op">=</span> <span class="st">"black"</span>, <span class="st">"FALSE"</span> <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot_matrix.html">plot_heatmap</a></span><span class="op">(</span><span class="va">incidence2</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Rearranged matrix"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"TRUE"</span> <span class="op">=</span> <span class="st">"black"</span>, <span class="st">"FALSE"</span> <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="seriation_files/figure-html/reciprocal-1.png" width="336"><img src="seriation_files/figure-html/reciprocal-2.png" width="336"></p>
<p>The positive difference from the column mean percentage (in french “écart positif au pourcentage moyen”, EPPM) represents a deviation from the situation of statistical independence <span class="citation">(Desachy 2004)</span>. As independence can be interpreted as the absence of relationships between types and the chronological order of the assemblages, EPPM is a useful graphical tool to explore significance of relationship between rows and columns related to seriation <span class="citation">(Desachy 2004)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Replicates Desachy 2004 results</span>
<span class="co">## Coerce dataset to an abundance matrix</span>
<span class="va">ccounts1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://arkhe.tesselle.org/reference/coerce.html">as_count</a></span><span class="op">(</span><span class="va">compiegne</span><span class="op">)</span>

<span class="co">## Plot original data matrix</span>
<span class="fu"><a href="../reference/plot_bar.html">plot_ford</a></span><span class="op">(</span><span class="va">ccounts1</span>, EPPM <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Original dataset"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">khroma</span><span class="fu">::</span><span class="fu"><a href="https://khroma.tesselle.org/reference/scale_tol_discrete.html">scale_fill_bright</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="seriation_files/figure-html/average-1.png" width="672"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">## Get seriation order for columns on EPPM using the reciprocal averaging method</span>
<span class="co">## Expected column order: N, A, C, K, P, L, B, E, I, M, D, G, O, J, F, H</span>
<span class="op">(</span><span class="va">cindices</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/seriation.html">seriate_rank</a></span><span class="op">(</span><span class="va">ccounts1</span>, EPPM <span class="op">=</span> <span class="cn">TRUE</span>, margin <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; &lt;PermutationOrder: reciprocal ranking&gt;</span>
<span class="co">#&gt; Permutation order for matrix seriation:</span>
<span class="co">#&gt; - Row order: 1 2 3 4 5...</span>
<span class="co">#&gt; - Column order: 14 1 3 11 16 12 2 5 9 13 4 7 15 10 6 8...</span>

<span class="co">## Permute columns</span>
<span class="va">ccounts2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/seriation.html">permute</a></span><span class="op">(</span><span class="va">ccounts1</span>, <span class="va">cindices</span><span class="op">)</span>

<span class="co">## Plot new matrix</span>
<span class="fu"><a href="../reference/plot_bar.html">plot_ford</a></span><span class="op">(</span><span class="va">ccounts2</span>, EPPM <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Reordered dataset"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">khroma</span><span class="fu">::</span><span class="fu"><a href="https://khroma.tesselle.org/reference/scale_tol_discrete.html">scale_fill_bright</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="seriation_files/figure-html/average-2.png" width="672"></p>
</div>
<div id="correspondence-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#correspondence-analysis" class="anchor"></a>correspondence analysis</h1>
<div id="seriation" class="section level2">
<h2 class="hasAnchor">
<a href="#seriation" class="anchor"></a>Seriation</h2>
<p>Correspondence Analysis (CA) is an effective method for the seriation of archaeological assemblages. The order of the rows and columns is given by the coordinates along one dimension of the CA space, assumed to account for temporal variation. The direction of temporal change within the correspondence analysis space is arbitrary: additional information is needed to determine the actual order in time.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Coerce dataset to an count matrix</span>
<span class="va">zcounts1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://arkhe.tesselle.org/reference/coerce.html">as_count</a></span><span class="op">(</span><span class="va">zuni</span><span class="op">)</span>

<span class="co">## correspondence analysis of the whole dataset</span>
<span class="va">corresp</span> <span class="op">&lt;-</span> <span class="fu">dimensio</span><span class="fu">::</span><span class="fu"><a href="http://dimensio.tesselle.org/reference/ca.html">ca</a></span><span class="op">(</span><span class="va">zcounts1</span><span class="op">)</span>

<span class="co">## Plot CA results</span>
<span class="fu">dimensio</span><span class="fu">::</span><span class="fu">plot</span><span class="op">(</span><span class="va">corresp</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="seriation_files/figure-html/ca-1.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Get row permutations from CA coordinates</span>
<span class="op">(</span><span class="va">zindices</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/seriation.html">seriate_average</a></span><span class="op">(</span><span class="va">zcounts1</span>, margin <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; &lt;PermutationOrder: average ranking&gt;</span>
<span class="co">#&gt; Permutation order for matrix seriation:</span>
<span class="co">#&gt; - Row order: 372 387 350 367 110 417 364 407 357 160 373 406 35...</span>
<span class="co">#&gt; - Column order: 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18...</span>

<span class="co">## Permute data matrix</span>
<span class="va">zcounts2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/seriation.html">permute</a></span><span class="op">(</span><span class="va">zcounts1</span>, <span class="va">zindices</span><span class="op">)</span>

<span class="co">## Plot Ford diagram</span>
<span class="co">## Warning: this may take a few seconds!</span>
<span class="fu"><a href="../reference/plot_bar.html">plot_ford</a></span><span class="op">(</span><span class="va">zcounts2</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Reordered dataset"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="seriation_files/figure-html/ca-seriation-1.png" width="672"></p>
</div>
<div id="refining" class="section level2">
<h2 class="hasAnchor">
<a href="#refining" class="anchor"></a>Refining</h2>
<p><span class="citation">Peeples and Schachner (2012)</span> propose a procedure to identify samples that are subject to sampling error or samples that have underlying structural relationships and might be influencing the ordering along the CA space. This relies on a partial bootstrap approach to CA-based seriation where each sample is replicated <code>n</code> times. The maximum dimension length of the convex hull around the sample point cloud allows to remove samples for a given <code>cutoff</code> value.</p>
<p>According to <span class="citation">Peeples and Schachner (2012)</span>, “[this] point removal procedure [results in] a reduced dataset where the position of individuals within the CA are highly stable and which produces an ordering consistend with the assumptions of frequency seriation.”</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Replicates Peeples and Schachner 2012 results</span>
<span class="co">## Samples with convex hull maximum dimension length greater than the cutoff</span>
<span class="co">## value will be marked for removal.</span>
<span class="co">## Define cutoff as one standard deviation above the mean</span>
<span class="va">fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">}</span>

<span class="co">## Get indices of samples to be kept</span>
<span class="co">## Warning: this may take a few seconds!</span>
<span class="op">(</span><span class="va">zuni_keep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/seriation.html">refine_seriation</a></span><span class="op">(</span><span class="va">corresp</span>, cutoff <span class="op">=</span> <span class="va">fun</span>, n <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; &lt;RefineCA&gt;</span>
<span class="co">#&gt; Partial bootstrap CA seriation refinement:</span>
<span class="co">#&gt; - Cutoff values: (rows) (columns) 2.55 - (rows) (columns) 0.38</span>
<span class="co">#&gt; - Rows to keep: 346 of 420 (82%)</span>
<span class="co">#&gt; - Columns to keep: 14 of 18 (78%)</span>

<span class="co">## Plot convex hull</span>
<span class="co">## blue: convex hull for samples; red: convex hull for types</span>
<span class="co">### All bootstrap samples</span>
<span class="va">rchull</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">zuni_keep</span><span class="op">[[</span><span class="st">"rows"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"chull"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>

<span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">rchull</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"blue"</span>, alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, size <span class="op">=</span> <span class="fl">0.5</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, size <span class="op">=</span> <span class="fl">0.5</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="seriation_files/figure-html/refine-1.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">### Only retained samples</span>
<span class="va">rchull_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subset.html">subset</a></span><span class="op">(</span><span class="va">rchull</span>, <span class="va">id</span> <span class="op">%in%</span> <span class="va">zuni_keep</span><span class="op">[[</span><span class="st">"rows"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"keep"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">rchull_sub</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, group <span class="op">=</span> <span class="va">id</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html">geom_polygon</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"blue"</span>, alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, size <span class="op">=</span> <span class="fl">0.5</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, size <span class="op">=</span> <span class="fl">0.5</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="seriation_files/figure-html/refine-2.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co">## Histogram of convex hull maximum dimension length</span>
<span class="va">hull_length</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>length <span class="op">=</span> <span class="va">zuni_keep</span><span class="op">[[</span><span class="st">"rows"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"length"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">hull_length</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">length</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4.5</span>, by <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"grey70"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu">fun</span><span class="op">(</span><span class="va">hull_length</span><span class="op">$</span><span class="va">length</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>
    title <span class="op">=</span> <span class="st">"Convex hull max. dim."</span>, 
    x <span class="op">=</span> <span class="st">"Maximum length"</span>, 
    y <span class="op">=</span> <span class="st">"Count"</span>
  <span class="op">)</span> <span class="op">+</span> 
  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="seriation_files/figure-html/refine-3.png" width="700"></p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-desachy2004">
<p>Desachy, Bruno. 2004. “Le Sériographe EPPM: Un Outil Informatisé de Sériation Graphique Pour Tableaux de Comptages.” <em>Revue Archéologique de Picardie</em> 3 (1): 39–56. <a href="https://doi.org/10.3406/pica.2004.2396">https://doi.org/10.3406/pica.2004.2396</a>.</p>
</div>
<div id="ref-dunnell1970">
<p>Dunnell, Robert C. 1970. “Seriation Method and Its Evaluation.” <em>American Antiquity</em> 35 (3): 305–19. <a href="https://doi.org/10.2307/278341">https://doi.org/10.2307/278341</a>.</p>
</div>
<div id="ref-ihm2005">
<p>Ihm, Peter. 2005. “A Contribution to the History of Seriation in Archaeology.” In <em>Classification – the Ubiquitous Challenge</em>, edited by Claus Weihs and Wolfgang Gaul, 307–16. Berlin Heidelberg: Springer. <a href="https://doi.org/10.1007/3-540-28084-7_34">https://doi.org/10.1007/3-540-28084-7_34</a>.</p>
</div>
<div id="ref-peeples2012">
<p>Peeples, Matthew A., and Gregson Schachner. 2012. “Refining Correspondence Analysis-Based Ceramic Seriation of Regional Data Sets.” <em>Journal of Archaeological Science</em> 39 (8): 2818–27. <a href="https://doi.org/10.1016/j.jas.2012.04.040">https://doi.org/10.1016/j.jas.2012.04.040</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Nicolas Frerebeau.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
