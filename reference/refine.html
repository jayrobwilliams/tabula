<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Bootstrap and Jackknife Resampling — refine • tabula</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Bootstrap and Jackknife Resampling — refine" />
<meta property="og:description" content="refine_ca performs a partial bootstrap correspondence analysis.
refine_date checks the stability of a DateModel object.
refine_diversity checks the stability of a
 DiversityIndex object." />
<meta property="og:image" content="http://tabula.archaeo.science/logo.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content="@nfrerebeau" />
<meta name="twitter:site" content="@nfrerebeau" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-172160955-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-172160955-1');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tabula</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/diversity.html">Diversity Measures</a>
    </li>
    <li>
      <a href="../articles/seriation.html">Seriation Methods</a>
    </li>
    <li>
      <a href="../articles/dating.html">Dating Methods</a>
    </li>
    <li>
      <a href="../articles/bibliography.html">Bibliography</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/nfrerebeau/tabula">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Bootstrap and Jackknife Resampling</h1>
    <small class="dont-index">Source: <a href='https://github.com/nfrerebeau/tabula/blob/master/R/AllGenerics.R'><code>R/AllGenerics.R</code></a>, <a href='https://github.com/nfrerebeau/tabula/blob/master/R/refine_ca.R'><code>R/refine_ca.R</code></a>, <a href='https://github.com/nfrerebeau/tabula/blob/master/R/refine_dates.R'><code>R/refine_dates.R</code></a>, and 1 more</small>
    <div class="hidden name"><code>refine.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>refine_ca</code> performs a partial bootstrap correspondence analysis.</p>
<p><code>refine_date</code> checks the stability of a <a href='http://tabula.archaeo.science/reference/DateClass.html'>DateModel</a> object.</p>
<p><code>refine_diversity</code> checks the stability of a
 <a href='http://tabula.archaeo.science/reference/DiversityIndex.html'>DiversityIndex</a> object.</p>
    </div>

    <pre class="usage"><span class='fu'><a href='http://tabula.archaeo.science/reference/refine.html'>refine_ca</a></span>(<span class='kw'>object</span>, <span class='kw'>...</span>)

<span class='fu'><a href='http://tabula.archaeo.science/reference/refine.html'>refine_diversity</a></span>(<span class='kw'>object</span>, <span class='kw'>...</span>)

<span class='fu'><a href='http://tabula.archaeo.science/reference/refine.html'>refine_event</a></span>(<span class='kw'>object</span>, <span class='kw'>...</span>)

<span class='co'># S4 method for CA</span>
<span class='fu'><a href='http://tabula.archaeo.science/reference/refine.html'>refine_ca</a></span>(<span class='kw'>object</span>, <span class='kw'>cutoff</span>, n = <span class='fl'>1000</span>, axes = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>2</span>), <span class='kw'>...</span>)

<span class='co'># S4 method for DateModel</span>
<span class='fu'><a href='http://tabula.archaeo.science/reference/refine.html'>refine_event</a></span>(
  <span class='kw'>object</span>,
  method = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"jackknife"</span>, <span class='st'>"bootstrap"</span>),
  level = <span class='fl'>0.95</span>,
  probs = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.05</span>, <span class='fl'>0.95</span>),
  n = <span class='fl'>1000</span>,
  <span class='kw'>...</span>
)

<span class='co'># S4 method for HeterogeneityIndex</span>
<span class='fu'><a href='http://tabula.archaeo.science/reference/refine.html'>refine_diversity</a></span>(
  <span class='kw'>object</span>,
  method = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"jackknife"</span>, <span class='st'>"bootstrap"</span>),
  probs = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.05</span>, <span class='fl'>0.95</span>),
  n = <span class='fl'>1000</span>,
  <span class='kw'>...</span>
)

<span class='co'># S4 method for EvennessIndex</span>
<span class='fu'><a href='http://tabula.archaeo.science/reference/refine.html'>refine_diversity</a></span>(
  <span class='kw'>object</span>,
  method = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"jackknife"</span>, <span class='st'>"bootstrap"</span>),
  probs = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.05</span>, <span class='fl'>0.95</span>),
  n = <span class='fl'>1000</span>,
  <span class='kw'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>A <a href='http://tabula.archaeo.science/reference/CA-class.html'>CA</a>, <a href='http://tabula.archaeo.science/reference/DateClass.html'>DateModel</a> or
<a href='http://tabula.archaeo.science/reference/DiversityIndex.html'>DiversityIndex</a> object.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Currently not used.</p></td>
    </tr>
    <tr>
      <th>cutoff</th>
      <td><p>A function that takes a numeric vector as argument and returns
a single numeric value (see below).</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>A non-negative <code><a href='https://rdrr.io/r/base/integer.html'>integer</a></code> giving the number of bootstrap
replications (see below).</p></td>
    </tr>
    <tr>
      <th>axes</th>
      <td><p>A <code><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></code> vector giving the subscripts of the CA
axes to be used (see below).</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>A <code><a href='https://rdrr.io/r/base/character.html'>character</a></code> string specifying the resampling
method to be used. This must be one of "<code>jackknife</code>",
"<code>bootstrap</code>" (see below). Any unambiguous substring can be given.</p></td>
    </tr>
    <tr>
      <th>level</th>
      <td><p>A length-one <code><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></code> vector giving the
confidence level.</p></td>
    </tr>
    <tr>
      <th>probs</th>
      <td><p>A <code><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></code> vector of probabilities with values in
\([0,1]\) (see <code><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></code>).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>refine_diversity</code> and <code>refine_event</code> return a
  <code><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></code>.</p>
<p><code>refine_ca</code> returns a <a href='http://tabula.archaeo.science/reference/BootCA-class.html'>BootCA</a> object.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Refining method can lead to much longer execution times and larger output
 objects. To monitor the execution of these re-sampling procedures, a
 progress bar will be displayed.</p>
    <h2 class="hasAnchor" id="correspondence-analysis-refining"><a class="anchor" href="#correspondence-analysis-refining"></a>Correspondence Analysis Refining</h2>

    

<p><code>refine_ca</code> allows to identify samples that are subject to
 sampling error or samples that have underlying structural relationships
 and might be influencing the ordering along the CA space.</p>
<p>This relies on a partial bootstrap approach to CA-based seriation where each
 sample is replicated <code>n</code> times. The maximum dimension length of
 the convex hull around the sample point cloud allows to remove samples for
 a given <code>cutoff</code> value.</p>
<p>According to Peebles and Schachner (2012), "[this] point removal procedure
 [results in] a reduced dataset where the position of individuals within the
 CA are highly stable and which produces an ordering consistent with the
 assumptions of frequency seriation."</p>
<p>If the results of <code><a href='http://tabula.archaeo.science/reference/refine.html'>refine</a></code> is used as an input argument in
 <code>seriate</code>, a correspondence analysis is performed on the subset of
 <code>object</code> which matches the samples to be kept. Then excluded samples
 are projected onto the dimensions of the CA coordinate space using the row
 transition formulae. Finally, row coordinates onto the first dimension
 give the seriation order.</p>
    <h2 class="hasAnchor" id="date-model-checking"><a class="anchor" href="#date-model-checking"></a>Date Model Checking</h2>

    

<p>If <code>jackknife</code> is used, one type/fabric is removed at a
 time and all statistics are recalculated. In this way, one can assess
 whether certain type/fabric has a substantial influence on the date
 estimate.
 A six columns <code><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></code> is returned, giving the results of
 the resampling procedure (jackknifing fabrics) for each assemblage (in rows)
 with the following columns:</p><dl>
  <dt>id</dt><dd><p>An identifier to link each row to an assemblage.</p></dd>
  <dt>date</dt><dd><p>The jackknife event date estimate.</p></dd>
  <dt>lower</dt><dd><p>The lower boundary of the associated prediction interval.</p></dd>
  <dt>upper</dt><dd><p>The upper boundary of the associated prediction interval.</p></dd>
  <dt>error</dt><dd><p>The standard error of predicted means.</p></dd>
  <dt>bias</dt><dd><p>The jackknife estimate of bias.</p></dd>
 
</dl>

<p>If <code>bootstrap</code> is used, a large number of new
 bootstrap assemblages is created, with the same sample size, by resampling
 each of the original assemblage with replacement. Then, examination of the
 bootstrap statistics makes it possible to pinpoint assemblages that require
 further investigation.
 A five columns <code><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></code> is returned, giving the bootstrap
 distribution statistics for each replicated assemblage (in rows)
 with the following columns:</p><dl>
  <dt>min</dt><dd><p>Minimum value.</p></dd>
  <dt>mean</dt><dd><p>Mean value (event date).</p></dd>
  <dt>max</dt><dd><p>Maximum value.</p></dd>
  <dt>Q5</dt><dd><p>Sample quantile to 0.05 probability.</p></dd>
  <dt>Q95</dt><dd><p>Sample quantile to 0.95 probability.</p></dd>
 
</dl>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Bellanger, L., Tomassone, R. &amp; Husi, P. (2008). A Statistical Approach for
 Dating Archaeological Contexts. <em>Journal of Data Science</em>, 6, 135-154.</p>
<p>Peeples, M. A., &amp; Schachner, G. (2012). Refining correspondence
 analysis-based ceramic seriation of regional data sets. <em>Journal of
 Archaeological Science</em>, 39(8), 2818-2827.
 DOI: <a href='https://doi.org/10.1016/j.jas.2012.04.040'>10.1016/j.jas.2012.04.040</a>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='http://tabula.archaeo.science/reference/event.html'>date_event</a>, <a href='http://tabula.archaeo.science/reference/heterogeneity-index.html'>index_heterogeneity</a>,
 <a href='http://tabula.archaeo.science/reference/heterogeneity-index.html'>index_evenness</a>, <a href='http://tabula.archaeo.science/reference/richness-index.html'>index_richness</a>, <a href='http://tabula.archaeo.science/reference/seriation.html'>seriate_correspondence</a></p>
<p>Other statistics: 
<code><a href='http://tabula.archaeo.science/reference/independance.html'>independance</a></code>,
<code><a href='http://tabula.archaeo.science/reference/test_diversity.html'>test_diversity</a>()</code>,
<code><a href='http://tabula.archaeo.science/reference/test_fit.html'>test_fit</a>()</code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>N. Frerebeau</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Data from Magurran 1988, p. 145-149</span>
<span class='kw'>birds</span> <span class='op'>&lt;-</span> <span class='fu'>CountMatrix</span>(
  data = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>35</span>, <span class='fl'>26</span>, <span class='fl'>25</span>, <span class='fl'>21</span>, <span class='fl'>16</span>, <span class='fl'>11</span>, <span class='fl'>6</span>, <span class='fl'>5</span>, <span class='fl'>3</span>, <span class='fl'>3</span>,
           <span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>2</span>, <span class='fl'>2</span>, <span class='fl'>2</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='fl'>0</span>,
           <span class='fl'>30</span>, <span class='fl'>30</span>, <span class='fl'>3</span>, <span class='fl'>65</span>, <span class='fl'>20</span>, <span class='fl'>11</span>, <span class='fl'>0</span>, <span class='fl'>4</span>, <span class='fl'>2</span>, <span class='fl'>14</span>,
           <span class='fl'>0</span>, <span class='fl'>3</span>, <span class='fl'>9</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>5</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>, <span class='fl'>1</span>),
  nrow = <span class='fl'>2</span>, byrow = <span class='fl'>TRUE</span>, dimnames = <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"oakwood"</span>, <span class='st'>"spruce"</span>), <span class='kw'>NULL</span>))

<span class='co'>## Shannon diversity</span>
<span class='kw'>heterogeneity</span> <span class='op'>&lt;-</span> <span class='fu'><a href='http://tabula.archaeo.science/reference/heterogeneity-index.html'>index_heterogeneity</a></span>(<span class='kw'>birds</span>, <span class='st'>"shannon"</span>)
<span class='fu'><a href='http://tabula.archaeo.science/reference/refine.html'>refine_diversity</a></span>(<span class='kw'>heterogeneity</span>, method = <span class='st'>"bootstrap"</span>)</div><div class='output co'>#&gt;         min      mean     max      Q5       Q95     
#&gt; oakwood 2.094642 2.35041  2.573477 2.23074  2.468232
#&gt; spruce  1.793914 2.021042 2.209898 1.915112 2.127804</div><div class='input'><span class='fu'><a href='http://tabula.archaeo.science/reference/refine.html'>refine_diversity</a></span>(<span class='kw'>heterogeneity</span>, method = <span class='st'>"jackknife"</span>)</div><div class='output co'>#&gt;         mean     bias       error    
#&gt; oakwood 2.362648 -0.9520239 0.1233832
#&gt; spruce  2.012326 -0.9169561 0.2490786</div><div class='input'>
<span class='co'>## Shannon evenness</span>
<span class='kw'>evenness</span> <span class='op'>&lt;-</span> <span class='fu'><a href='http://tabula.archaeo.science/reference/heterogeneity-index.html'>index_evenness</a></span>(<span class='kw'>birds</span>, <span class='st'>"shannon"</span>)
<span class='fu'><a href='http://tabula.archaeo.science/reference/refine.html'>refine_diversity</a></span>(<span class='kw'>evenness</span>, method = <span class='st'>"bootstrap"</span>)</div><div class='output co'>#&gt;         min       mean      max       Q5        Q95      
#&gt; oakwood 0.7233923 0.8152063 0.8876801 0.7793649 0.8508275
#&gt; spruce  0.7101253 0.7888973 0.8581119 0.748665  0.82948  </div><div class='input'><span class='fu'><a href='http://tabula.archaeo.science/reference/refine.html'>refine_diversity</a></span>(<span class='kw'>evenness</span>, method = <span class='st'>"jackknife"</span>)</div><div class='output co'>#&gt;         mean      bias        error     
#&gt; oakwood 0.8011374 -0.05600727 0.03567978
#&gt; spruce  0.776363  -0.05669112 0.07771685</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Nicolas Frerebeau.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


