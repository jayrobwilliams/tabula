<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Matrix Seriation — seriation • tabula</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Matrix Seriation — seriation" />
<meta property="og:description" content="* seriate_* computes a permutation order for rows and/or columns.
 * permute rearranges a data matrix according to a permutation order.
 * get_order returns the seriation order for rows and columns." />
<meta property="og:image" content="https://tabula.tesselle.org/logo.png" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:creator" content="@nfrerebeau" />
<meta name="twitter:site" content="@nfrerebeau" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tabula</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.6.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/diversity.html">Diversity Measures</a>
    </li>
    <li>
      <a href="../articles/seriation.html">Seriation Methods</a>
    </li>
    <li>
      <a href="../articles/dating.html">Dating Methods</a>
    </li>
    <li>
      <a href="../articles/bibliography.html">Bibliography</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/nfrerebeau/tabula">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Matrix Seriation</h1>
    <small class="dont-index">Source: <a href='https://github.com/tesselle/tabula/blob/master/R/AllGenerics.R'><code>R/AllGenerics.R</code></a>, <a href='https://github.com/tesselle/tabula/blob/master/R/deprecate.R'><code>R/deprecate.R</code></a>, <a href='https://github.com/tesselle/tabula/blob/master/R/mutators.R'><code>R/mutators.R</code></a>, and 4 more</small>
    <div class="hidden name"><code>seriation.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>* <code>seriate_*</code> computes a permutation order for rows and/or columns.
 * <code>permute</code> rearranges a data matrix according to a permutation order.
 * <code>get_order</code> returns the seriation order for rows and columns.</p>
    </div>

    <pre class="usage"><span class='fu'>seriate_average</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>seriate_rank</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>permute</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>order</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>refine_seriation</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for CountMatrix</span>
<span class='fu'><a href='deprecate.html'>seriate_correspondence</a></span><span class='op'>(</span><span class='va'>object</span>, margin <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for IncidenceMatrix</span>
<span class='fu'><a href='deprecate.html'>seriate_correspondence</a></span><span class='op'>(</span><span class='va'>object</span>, margin <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for PermutationOrder</span>
<span class='fu'><a href='mutator.html'>get_order</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>

<span class='co'># S4 method for CountMatrix,PermutationOrder</span>
<span class='fu'>permute</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>order</span><span class='op'>)</span>

<span class='co'># S4 method for IncidenceMatrix,PermutationOrder</span>
<span class='fu'>permute</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>order</span><span class='op'>)</span>

<span class='co'># S4 method for CA</span>
<span class='fu'>refine_seriation</span><span class='op'>(</span>
  <span class='va'>object</span>,
  <span class='va'>cutoff</span>,
  n <span class='op'>=</span> <span class='fl'>1000</span>,
  axes <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span>,
  progress <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"tabula.progress"</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S4 method for CountMatrix</span>
<span class='fu'>seriate_average</span><span class='op'>(</span><span class='va'>object</span>, margin <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span>, axes <span class='op'>=</span> <span class='fl'>1</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for IncidenceMatrix</span>
<span class='fu'>seriate_average</span><span class='op'>(</span><span class='va'>object</span>, margin <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span>, axes <span class='op'>=</span> <span class='fl'>1</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S4 method for CountMatrix</span>
<span class='fu'>seriate_rank</span><span class='op'>(</span><span class='va'>object</span>, EPPM <span class='op'>=</span> <span class='cn'>FALSE</span>, margin <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span>, stop <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>

<span class='co'># S4 method for IncidenceMatrix</span>
<span class='fu'>seriate_rank</span><span class='op'>(</span><span class='va'>object</span>, margin <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span><span class='op'>)</span>, stop <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object, x</th>
      <td><p>An \(m \times p\) data matrix (typically an object
of class CountMatrix or IncidenceMatrix.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Further arguments to be passed to internal methods.</p></td>
    </tr>
    <tr>
      <th>order</th>
      <td><p>A <a href='PermutationOrder-class.html'>PermutationOrder</a> object giving the permutation
order for rows and columns.</p></td>
    </tr>
    <tr>
      <th>margin</th>
      <td><p>A <code><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></code> vector giving the subscripts which the
rearrangement will be applied over: <code>1</code> indicates rows, <code>2</code>
indicates columns, <code><a href='https://rdrr.io/r/base/c.html'>c(1, 2)</a></code> indicates rows then columns,
<code><a href='https://rdrr.io/r/base/c.html'>c(2, 1)</a></code> indicates columns then rows.</p></td>
    </tr>
    <tr>
      <th>cutoff</th>
      <td><p>A function that takes a numeric vector as argument and returns
a single numeric value (see below).</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>A non-negative <code><a href='https://rdrr.io/r/base/integer.html'>integer</a></code> giving the number of bootstrap
replications.</p></td>
    </tr>
    <tr>
      <th>axes</th>
      <td><p>An <code><a href='https://rdrr.io/r/base/integer.html'>integer</a></code> vector giving the subscripts of the CA
axes to be used.</p></td>
    </tr>
    <tr>
      <th>progress</th>
      <td><p>A <code><a href='https://rdrr.io/r/base/logical.html'>logical</a></code> scalar: should a progress bar be
displayed?</p></td>
    </tr>
    <tr>
      <th>EPPM</th>
      <td><p>A <code><a href='https://rdrr.io/r/base/logical.html'>logical</a></code> scalar: should the seriation be computed
on EPPM instead of raw data?</p></td>
    </tr>
    <tr>
      <th>stop</th>
      <td><p>An <code><a href='https://rdrr.io/r/base/integer.html'>integer</a></code> giving the stopping rule
(i.e. maximum number of iterations) to avoid infinite loop.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>seriate_*</code> returns a <a href='PermutationOrder-class.html'>PermutationOrder</a> object.</p>
<p><code>refine_seriation</code> returns a <a href='RefineCA-class.html'>RefineCA</a> object.</p>
<p><code>permute</code> returns either a permuted CountMatrix or an
 IncidenceMatrix (the same as <code>object</code>).</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Refining method can lead to much longer execution times and larger output
 objects.</p>
    <h2 class="hasAnchor" id="seriation"><a class="anchor" href="#seriation"></a>Seriation</h2>

    

<p>The matrix seriation problem in archaeology is based on three conditions
 and two assumptions, which Dunell (1970) summarizes as follows.</p>
<p>The homogeneity conditions state that all the groups included in a
 seriation must:</p><ol>
<li><p>Be of comparable duration.</p></li>
<li><p>Belong to the same cultural tradition.</p></li>
<li><p>Come from the same local area.</p></li>
</ol>

<p>The mathematical assumptions state that the distribution of any historical
 or temporal class:</p><ol>
<li><p>Is continuous through time.</p></li>
<li><p>Exhibits the form of a unimodal curve.</p></li>
</ol><p>Theses assumptions create a distributional model and ordering is
 accomplished by arranging the matrix so that the class distributions
 approximate the required pattern. The resulting order is inferred
 to be chronological.</p>
<p>The following seriation methods are available:</p><dl>
  <dt><code>seriate_average</code></dt><dd><p>Correspondence analysis-based seriation
  (average ranking). Correspondence analysis (CA) is an effective method for
  the seriation of archaeological assemblages. The order of the rows and
  columns is given by the coordinates along one dimension of the CA space,
  assumed to account for temporal variation. The direction of temporal change
  within the correspondence analysis space is arbitrary: additional
  information is needed to determine the actual order in time.</p></dd>
  <dt><code>seriate_rank</code></dt><dd><p>Reciprocal ranking seriation. These procedures
  iteratively rearrange rows and/or columns according to their weighted rank
  in the data matrix until convergence.
  Note that this procedure could enter into an infinite loop.
  If no convergence is reached before the maximum number of iterations, it
  stops with a warning.</p></dd>
 
</dl>

    <h2 class="hasAnchor" id="correspondence-analysis"><a class="anchor" href="#correspondence-analysis"></a>Correspondence Analysis</h2>

    

<p><code>refine_seriation</code> allows to identify samples that are subject to
 sampling error or samples that have underlying structural relationships
 and might be influencing the ordering along the CA space.</p>
<p>This relies on a partial bootstrap approach to CA-based seriation where each
 sample is replicated <code>n</code> times. The maximum dimension length of
 the convex hull around the sample point cloud allows to remove samples for
 a given <code>cutoff</code> value.</p>
<p>According to Peebles and Schachner (2012), "[this] point removal procedure
 [results in] a reduced dataset where the position of individuals within the
 CA are highly stable and which produces an ordering consistent with the
 assumptions of frequency seriation."</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Desachy, B. (2004). Le sériographe EPPM: un outil informatisé de sériation
 graphique pour tableaux de comptages. <em>Revue archéologique de
 Picardie</em>, 3(1), 39-56. doi: <a href='https://doi.org/10.3406/pica.2004.2396'>10.3406/pica.2004.2396</a>
.</p>
<p>Dunnell, R. C. (1970). Seriation Method and Its Evaluation. <em>American
 Antiquity</em>, 35(03), 305-319. doi: <a href='https://doi.org/10.2307/278341'>10.2307/278341</a>
.</p>
<p>Ihm, P. (2005). A Contribution to the History of Seriation in Archaeology.
 In C. Weihs &amp; W. Gaul (Eds.), <em>Classification: The Ubiquitous
 Challenge</em>. Berlin Heidelberg: Springer, p. 307-316.
 doi: <a href='https://doi.org/10.1007/3-540-28084-7_34'>10.1007/3-540-28084-7_34</a>
.</p>
<p>Peeples, M. A., &amp; Schachner, G. (2012). Refining correspondence
 analysis-based ceramic seriation of regional data sets. <em>Journal of
 Archaeological Science</em>, 39(8), 2818-2827.
 doi: <a href='https://doi.org/10.1016/j.jas.2012.04.040'>10.1016/j.jas.2012.04.040</a>
.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>refine_seriation, <a href='http://dimensio.tesselle.org/reference/ca.html'>ca</a></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>N. Frerebeau</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Replicates Desachy 2004 results</span>
<span class='co'>## Coerce dataset to abundance matrix</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"compiegne"</span>, package <span class='op'>=</span> <span class='st'>"folio"</span><span class='op'>)</span>
<span class='va'>compiegne_count</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://arkhe.tesselle.org/reference/coerce.html'>as_count</a></span><span class='op'>(</span><span class='va'>compiegne</span><span class='op'>)</span>

<span class='co'>## Get seriation order for columns on EPPM using the reciprocal averaging method</span>
<span class='co'>## Expected column order: N, A, C, K, P, L, B, E, I, M, D, G, O, J, F, H</span>
<span class='op'>(</span><span class='va'>compiegne_indices</span> <span class='op'>&lt;-</span> <span class='fu'>seriate_rank</span><span class='op'>(</span><span class='va'>compiegne_count</span>, EPPM <span class='op'>=</span> <span class='cn'>TRUE</span>, margin <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; &lt;PermutationOrder: reciprocal ranking&gt;
#&gt; Permutation order for matrix seriation:
#&gt; - Row order: 1 2 3 4 5...
#&gt; - Column order: 14 1 3 11 16 12 2 5 9 13 4 7 15 10 6 8...</div><div class='input'>
<span class='co'>## Permute columns</span>
<span class='va'>compiegne_new</span> <span class='op'>&lt;-</span> <span class='fu'>permute</span><span class='op'>(</span><span class='va'>compiegne_count</span>, <span class='va'>compiegne_indices</span><span class='op'>)</span>

<span class='co'>## Plot new matrix</span>
<span class='fu'><a href='plot_bar.html'>plot_ford</a></span><span class='op'>(</span><span class='va'>compiegne_new</span>, EPPM <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='img'><img src='seriation-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## See the vignette:</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='fu'>utils</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/utils/vignette.html'>vignette</a></span><span class='op'>(</span><span class='st'>"seriation"</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Nicolas Frerebeau.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


